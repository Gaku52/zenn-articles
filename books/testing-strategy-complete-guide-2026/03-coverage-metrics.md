---
title: "Chapter 03 - ã‚«ãƒãƒ¬ãƒƒã‚¸ã¨ãƒ¡ãƒˆãƒªã‚¯ã‚¹"
---

# Chapter 03 - ã‚«ãƒãƒ¬ãƒƒã‚¸ã¨ãƒ¡ãƒˆãƒªã‚¯ã‚¹

## å­¦ç¿’ç›®æ¨™

ã“ã®ç« ã‚’èª­ã¿çµ‚ãˆãŸå¾Œã€ä»¥ä¸‹ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™:

âœ… 4ç¨®é¡ã®ã‚«ãƒãƒ¬ãƒƒã‚¸ï¼ˆStatement/Branch/Function/Lineï¼‰ã‚’ç†è§£ã§ãã‚‹
âœ… é©åˆ‡ãªã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™ï¼ˆ80%+ï¼‰ã®æ ¹æ‹ ã‚’èª¬æ˜ã§ãã‚‹
âœ… ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ„ãƒ¼ãƒ«ï¼ˆJestã€c8ã€Istanbulï¼‰ã‚’è¨­å®šãƒ»é‹ç”¨ã§ãã‚‹
âœ… ã‚«ãƒãƒ¬ãƒƒã‚¸ã¨ãƒã‚°æ¤œå‡ºç‡ã®ç›¸é–¢ãƒ‡ãƒ¼ã‚¿ã‚’ç†è§£ã§ãã‚‹

**é›£æ˜“åº¦**: â˜…â˜…â˜†â˜†â˜† (åˆç´šã€œä¸­ç´š)
**æ‰€è¦æ™‚é–“**: 25åˆ†

---

## 1. ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã¨ã¯

### 1.1 å®šç¾©

**ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸**ã¯ã€ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒå®Ÿè¡Œã‚³ãƒ¼ãƒ‰ã®ã©ã‚Œã ã‘ã‚’ã‚«ãƒãƒ¼ã—ã¦ã„ã‚‹ã‹ã‚’ç¤ºã™æŒ‡æ¨™ã§ã™ã€‚

#### ãªãœé‡è¦ã‹

```
âœ… ãƒ†ã‚¹ãƒˆã®ç¶²ç¾…æ€§ã‚’å¯è¦–åŒ–
âœ… ãƒ†ã‚¹ãƒˆã•ã‚Œã¦ã„ãªã„ã‚³ãƒ¼ãƒ‰ã‚’ç‰¹å®š
âœ… å“è³ªæ”¹å–„ã®ç›®æ¨™è¨­å®š
âœ… ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³é˜²æ­¢ã®æŒ‡æ¨™
```

**æƒ³å®šã•ã‚Œã‚‹åŠ¹æœ:**

| ã‚«ãƒãƒ¬ãƒƒã‚¸ | æœ¬ç•ªãƒã‚°æ•°/æœˆ | ãƒ‡ã‚°ãƒ¬ãƒ¼ãƒ‰/å¹´ | ãƒªãƒªãƒ¼ã‚¹å“è³ª |
|----------|------------|------------|-----------|
| 0-30% | 45ä»¶ | 24å› | ä¸å®‰å®š |
| 30-60% | 18ä»¶ | 12å› | æ”¹å–„ä¸­ |
| 60-80% | 8ä»¶ | 4å› | å®‰å®š |
| 80-95% | 2ä»¶ | 1å› | éå¸¸ã«å®‰å®š |
| 95-100% | 1ä»¶ | 0å› | æ¥µã‚ã¦å®‰å®š |

#### æ³¨æ„ç‚¹

```
âš ï¸ ã‚«ãƒãƒ¬ãƒƒã‚¸100%ã§ã‚‚ãƒã‚°ã¯ã‚¼ãƒ­ã«ãªã‚‰ãªã„
âš ï¸ è³ªã®ä½ã„ãƒ†ã‚¹ãƒˆã§ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’ç¨¼ã„ã§ã‚‚æ„å‘³ãŒãªã„
âš ï¸ ã‚«ãƒãƒ¬ãƒƒã‚¸ã¯æ‰‹æ®µã§ã‚ã‚Šã€ç›®çš„ã§ã¯ãªã„
```

---

### 1.2 ã‚«ãƒãƒ¬ãƒƒã‚¸ã®æ­´å²

#### 1960å¹´ä»£: æ§‹é€ ã‚«ãƒãƒ¬ãƒƒã‚¸ã®èª•ç”Ÿ

- **Statement Coverage**ãŒæœ€åˆã«æå”±ã•ã‚Œã‚‹
- ä¸»ã«è»äº‹ãƒ»èˆªç©ºå®‡å®™åˆ†é‡ã§ä½¿ç”¨

#### 1980å¹´ä»£: ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ„ãƒ¼ãƒ«ã®ç™»å ´

- **Branch Coverage**ã®é‡è¦æ€§ãŒèªè­˜ã•ã‚Œã‚‹
- è‡ªå‹•ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®šãƒ„ãƒ¼ãƒ«ã®é–‹ç™º

#### 2000å¹´ä»£: ã‚¢ã‚¸ãƒ£ã‚¤ãƒ«æ™‚ä»£

- **Martin Fowler**ãŒã€Œãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ã®é©åˆ‡ãªä½¿ã„æ–¹ã€ã‚’æå”±
- CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¸ã®çµ±åˆãŒä¸€èˆ¬åŒ–

#### 2010å¹´ä»£ã€œç¾åœ¨

- **80%ãƒ«ãƒ¼ãƒ«**ãŒæ¥­ç•Œæ¨™æº–ã«
- ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã®å¯è¦–åŒ–ãŒé€²åŒ–

---

## 2. ã‚«ãƒãƒ¬ãƒƒã‚¸ã®ç¨®é¡

### 2.1 Statement Coverageï¼ˆã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸ï¼‰

**å®šç¾©:** å®Ÿè¡Œã•ã‚ŒãŸæ–‡ã®å‰²åˆ

**è¨ˆç®—å¼:**
```
Statement Coverage = (å®Ÿè¡Œã•ã‚ŒãŸæ–‡ã®æ•° / å…¨ä½“ã®æ–‡ã®æ•°) Ã— 100
```

**ä¾‹:**

```typescript
function getUserStatus(user: User) {
  console.log('Checking user status') // Statement 1
  if (user.isActive) {                  // Statement 2
    return 'active'                      // Statement 3
  }
  return 'inactive'                      // Statement 4
}

// ãƒ†ã‚¹ãƒˆ1: isActive = true
getUserStatus({ isActive: true })
// â†’ Statement 1, 2, 3 ãŒå®Ÿè¡Œ
// â†’ Statement Coverage = 3/4 = 75%

// ãƒ†ã‚¹ãƒˆ2: isActive = false ã‚‚è¿½åŠ 
getUserStatus({ isActive: false })
// â†’ Statement 1, 2, 4 ãŒå®Ÿè¡Œ
// â†’ Statement Coverage = 4/4 = 100%
```

---

### 2.2 Branch Coverageï¼ˆåˆ†å²ã‚«ãƒãƒ¬ãƒƒã‚¸ï¼‰

**å®šç¾©:** å®Ÿè¡Œã•ã‚ŒãŸåˆ†å²ã®å‰²åˆ

**è¨ˆç®—å¼:**
```
Branch Coverage = (å®Ÿè¡Œã•ã‚ŒãŸåˆ†å²ã®æ•° / å…¨ä½“ã®åˆ†å²ã®æ•°) Ã— 100
```

**ä¾‹:**

```typescript
function applyDiscount(total: number, isPremium: boolean) {
  if (total > 1000) {              // Branch 1: true/false
    if (isPremium) {                // Branch 2: true/false
      return total * 0.8             // 20% discount
    }
    return total * 0.9               // 10% discount
  }
  return total                       // No discount
}

// ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹1: total=1500, isPremium=true
applyDiscount(1500, true)
// â†’ Branch 1 (true), Branch 2 (true)
// â†’ Branch Coverage = 2/4 = 50%

// ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹2: total=500, isPremium=false
applyDiscount(500, false)
// â†’ Branch 1 (false)
// â†’ Branch Coverage = 3/4 = 75%

// ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹3: total=1500, isPremium=false
applyDiscount(1500, false)
// â†’ Branch 1 (true), Branch 2 (false)
// â†’ Branch Coverage = 4/4 = 100%
```

---

### 2.3 Function Coverageï¼ˆé–¢æ•°ã‚«ãƒãƒ¬ãƒƒã‚¸ï¼‰

**å®šç¾©:** å®Ÿè¡Œã•ã‚ŒãŸé–¢æ•°ã®å‰²åˆ

**è¨ˆç®—å¼:**
```
Function Coverage = (å®Ÿè¡Œã•ã‚ŒãŸé–¢æ•°ã®æ•° / å…¨ä½“ã®é–¢æ•°ã®æ•°) Ã— 100
```

**ä¾‹:**

```typescript
// src/utils/math.ts
export function add(a: number, b: number): number {
  return a + b
}

export function subtract(a: number, b: number): number {
  return a - b
}

export function multiply(a: number, b: number): number {
  return a * b
}

export function divide(a: number, b: number): number {
  if (b === 0) throw new Error('Division by zero')
  return a / b
}

// ãƒ†ã‚¹ãƒˆ
describe('Math utils', () => {
  it('should add numbers', () => {
    expect(add(2, 3)).toBe(5)
  })

  it('should multiply numbers', () => {
    expect(multiply(2, 3)).toBe(6)
  })
})

// Function Coverage = 2/4 = 50%
// subtract ã¨ divide ãŒãƒ†ã‚¹ãƒˆã•ã‚Œã¦ã„ãªã„
```

---

### 2.4 Line Coverageï¼ˆè¡Œã‚«ãƒãƒ¬ãƒƒã‚¸ï¼‰

**å®šç¾©:** å®Ÿè¡Œã•ã‚ŒãŸè¡Œã®å‰²åˆ

**è¨ˆç®—å¼:**
```
Line Coverage = (å®Ÿè¡Œã•ã‚ŒãŸè¡Œã®æ•° / å…¨ä½“ã®è¡Œã®æ•°) Ã— 100
```

**ä¾‹:**

```typescript
function processOrder(order: Order) {
  validateOrder(order)                        // Line 1
  const total = calculateTotal(order.items)   // Line 2
  const discount = applyDiscount(total)       // Line 3
  const tax = calculateTax(total - discount)  // Line 4
  return total - discount + tax               // Line 5
}

// ãƒ†ã‚¹ãƒˆ
it('should process order', () => {
  const order = { items: [{ price: 100 }] }
  processOrder(order)
})

// Line Coverage = 5/5 = 100%
// ã™ã¹ã¦ã®è¡ŒãŒå®Ÿè¡Œã•ã‚ŒãŸ
```

---

### 2.5 ã‚«ãƒãƒ¬ãƒƒã‚¸ã®å„ªå…ˆé †ä½

**æ¨å¥¨å„ªå…ˆé †ä½:**

```
1. Branch Coverage     (æœ€é‡è¦)
2. Function Coverage   (æ¬¡ã«é‡è¦)
3. Statement Coverage  (åŸºæœ¬)
4. Line Coverage       (å‚è€ƒ)
```

**ç†ç”±:**

```
Branch Coverage:
  â†’ ãƒã‚°ã®80%ã¯æ¡ä»¶åˆ†å²ã§ç™ºç”Ÿ
  â†’ ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã®æ¤œå‡ºã«åŠ¹æœçš„

Function Coverage:
  â†’ æœªãƒ†ã‚¹ãƒˆã®é–¢æ•°ã‚’ç‰¹å®š
  â†’ APIå…¨ä½“ã®ç¶²ç¾…æ€§ã‚’ç¢ºèª

Statement Coverage:
  â†’ åŸºæœ¬çš„ãªå®Ÿè¡Œãƒ‘ã‚¹ã‚’ç¢ºèª
  â†’ æœ€ã‚‚ç°¡å˜ã«æ¸¬å®šå¯èƒ½

Line Coverage:
  â†’ Statement Coverageã¨ã»ã¼åŒã˜
  â†’ ä¸»ã«å‚è€ƒç¨‹åº¦
```

---

## 3. é©åˆ‡ãªã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™

### 3.1 æ¥­ç•Œæ¨™æº–: 80%ãƒ«ãƒ¼ãƒ«

**80%+ã®ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™ãŒæ¨å¥¨ã•ã‚Œã‚‹ç†ç”±:**

#### ãƒ‡ãƒ¼ã‚¿ã«åŸºã¥ãæ ¹æ‹ 

**Microsoft Research (2013å¹´):**
- ã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Šã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: ãƒã‚°å¯†åº¦ **0.3ä»¶/KLOC**
- ã‚«ãƒãƒ¬ãƒƒã‚¸50%æœªæº€ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ: ãƒã‚°å¯†åº¦ **2.1ä»¶/KLOC**
- **ç´„7å€ã®å·®**

**Google Testing Blog (2015å¹´):**
- ã‚«ãƒãƒ¬ãƒƒã‚¸80-90%: æœ€ã‚‚ã‚³ã‚¹ãƒˆåŠ¹ç‡ãŒè‰¯ã„
- 90%è¶…: ã‚³ã‚¹ãƒˆãŒæ€¥å¢—ï¼ˆROIãŒä½ä¸‹ï¼‰
- 80%æœªæº€: ãƒã‚°æ¼ã‚ŒãŒå¢—åŠ 

#### 80%ãƒ«ãƒ¼ãƒ«ã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯æŒ‡æ¨™

```
ã‚«ãƒãƒ¬ãƒƒã‚¸ 70% â†’ 80%: ãƒã‚°å‰Šæ¸›åŠ¹æœ +45%
ã‚«ãƒãƒ¬ãƒƒã‚¸ 80% â†’ 90%: ãƒã‚°å‰Šæ¸›åŠ¹æœ +15%
ã‚«ãƒãƒ¬ãƒƒã‚¸ 90% â†’ 100%: ãƒã‚°å‰Šæ¸›åŠ¹æœ +5%
```

**ROIåˆ†æ:**

| ã‚«ãƒãƒ¬ãƒƒã‚¸ç¯„å›² | ãƒ†ã‚¹ãƒˆå·¥æ•° | ãƒã‚°å‰Šæ¸›åŠ¹æœ | ROI |
|------------|----------|------------|-----|
| 0% â†’ 60% | 100æ™‚é–“ | 60% | **é«˜** |
| 60% â†’ 80% | 80æ™‚é–“ | 25% | **ä¸­** |
| 80% â†’ 95% | 120æ™‚é–“ | 10% | **ä½** |
| 95% â†’ 100% | 200æ™‚é–“ | 5% | **éå¸¸ã«ä½** |

---

### 3.2 ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚¿ã‚¤ãƒ—åˆ¥ã®ç›®æ¨™

#### ã‚¯ãƒªãƒ†ã‚£ã‚«ãƒ«ã‚·ã‚¹ãƒ†ãƒ ï¼ˆé‡‘èã€åŒ»ç™‚ã€èˆªç©ºï¼‰

```
Statement Coverage: 95%+
Branch Coverage:    95%+
Function Coverage:  100%

ç†ç”±:
  - äººå‘½ã‚„è²¡ç”£ã«é–¢ã‚ã‚‹
  - æ³•è¦åˆ¶ã®è¦ä»¶
  - ãƒã‚°ã®å½±éŸ¿ãŒç”šå¤§
```

#### æ¨™æº–çš„ãªWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³

```
Statement Coverage: 80%+
Branch Coverage:    80%+
Function Coverage:  90%+

ç†ç”±:
  - ã‚³ã‚¹ãƒˆã¨åŠ¹æœã®ãƒãƒ©ãƒ³ã‚¹
  - ç¶™ç¶šçš„ãªé–‹ç™ºãŒå¿…è¦
  - æ¥­ç•Œæ¨™æº–
```

#### å®Ÿé¨“çš„ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—

```
Statement Coverage: 50%+
Branch Coverage:    50%+
Function Coverage:  60%+

ç†ç”±:
  - è¿…é€Ÿãªæ¤œè¨¼ãŒå„ªå…ˆ
  - ä»•æ§˜å¤‰æ›´ãŒé »ç¹
  - é•·æœŸé‹ç”¨ã®äºˆå®šãŒãªã„
```

---

### 3.3 æ®µéšçš„ãªç›®æ¨™è¨­å®š

**ãƒ¬ã‚¬ã‚·ãƒ¼ã‚³ãƒ¼ãƒ‰ã¸ã®ã‚«ãƒãƒ¬ãƒƒã‚¸å°å…¥:**

```
Phase 1 (Month 1-2):
  - ç¾çŠ¶æ¸¬å®š: 15%
  - ç›®æ¨™: 30%
  - æ–°è¦ã‚³ãƒ¼ãƒ‰ã®ã¿ã‚«ãƒãƒ¬ãƒƒã‚¸å¿…é ˆåŒ–

Phase 2 (Month 3-4):
  - ç›®æ¨™: 50%
  - é‡è¦ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ãƒ†ã‚¹ãƒˆè¿½åŠ 
  - CI/CDã«ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒã‚§ãƒƒã‚¯è¿½åŠ 

Phase 3 (Month 5-6):
  - ç›®æ¨™: 70%
  - ãƒã‚°ãŒå¤šã„ç®‡æ‰€ã‚’å„ªå…ˆçš„ã«ãƒ†ã‚¹ãƒˆ

Phase 4 (Month 7-12):
  - ç›®æ¨™: 80%
  - å…¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§80%é”æˆ
  - ç¶™ç¶šçš„ãªç¶­æŒ
```

---

## 4. ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ„ãƒ¼ãƒ«

### 4.1 Jestï¼ˆJavaScript/TypeScriptï¼‰

#### è¨­å®š

```javascript
// jest.config.js
module.exports = {
  preset: 'ts-jest',
  testEnvironment: 'node',
  collectCoverage: true,
  collectCoverageFrom: [
    'src/**/*.ts',
    '!src/**/*.d.ts',
    '!src/**/*.test.ts',
    '!src/index.ts',
  ],
  coverageThreshold: {
    global: {
      branches: 80,
      functions: 80,
      lines: 80,
      statements: 80,
    },
    './src/services/': {
      branches: 90,
      functions: 90,
      lines: 90,
      statements: 90,
    },
  },
  coverageReporters: [
    'text',
    'text-summary',
    'html',
    'lcov',
    'json-summary',
  ],
}
```

#### å®Ÿè¡Œ

```bash
# ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®š
npm run test -- --coverage

# å‡ºåŠ›ä¾‹
-----------------------|---------|----------|---------|---------|-------------------
File                   | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
-----------------------|---------|----------|---------|---------|-------------------
All files              |   87.5  |   82.35  |   90.91 |   88.24 |
 src/services          |   95.24 |   88.89  |   100   |   95.24 |
  UserService.ts       |   95.24 |   88.89  |   100   |   95.24 | 45-47
 src/utils             |   75.86 |   70.59  |   81.82 |   76.92 |
  validators.ts        |   75.86 |   70.59  |   81.82 |   76.92 | 23-25,38-42
-----------------------|---------|----------|---------|---------|-------------------
```

#### HTMLãƒ¬ãƒãƒ¼ãƒˆ

```bash
# HTMLãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ
npm run test -- --coverage --coverageReporters=html

# ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã
open coverage/lcov-report/index.html
```

**HTMLãƒ¬ãƒãƒ¼ãƒˆã®è¦‹æ–¹:**
- ğŸŸ¢ Green: 80%ä»¥ä¸Šï¼ˆè‰¯å¥½ï¼‰
- ğŸŸ¡ Yellow: 60-80%ï¼ˆè¦æ”¹å–„ï¼‰
- ğŸ”´ Red: 60%æœªæº€ï¼ˆæ”¹å–„å¿…é ˆï¼‰

---

### 4.2 c8ï¼ˆNode.jsç”¨ï¼‰

**ç‰¹å¾´:**
- V8ã‚¨ãƒ³ã‚¸ãƒ³ã®çµ„ã¿è¾¼ã¿ã‚«ãƒãƒ¬ãƒƒã‚¸æ©Ÿèƒ½ã‚’ä½¿ç”¨
- **éå¸¸ã«é«˜é€Ÿ**
- **æ­£ç¢º**ï¼ˆè¨ˆè£…ä¸è¦ï¼‰

#### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install --save-dev c8
```

#### è¨­å®š

```json
// package.json
{
  "scripts": {
    "test:coverage": "c8 npm test"
  },
  "c8": {
    "all": true,
    "include": ["src/**/*.ts"],
    "exclude": [
      "**/*.test.ts",
      "**/*.d.ts"
    ],
    "reporter": ["text", "html", "lcov"],
    "check-coverage": true,
    "lines": 80,
    "functions": 80,
    "branches": 80,
    "statements": 80
  }
}
```

#### å®Ÿè¡Œ

```bash
npm run test:coverage

# å‡ºåŠ›ä¾‹
----------|---------|----------|---------|---------|-------------------
File      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s
----------|---------|----------|---------|---------|-------------------
All files |   87.5  |   82.35  |   90.91 |   88.24 |
 index.ts |   100   |   100    |   100   |   100   |
 utils.ts |   75    |   66.67  |   83.33 |   75    | 15-18
----------|---------|----------|---------|---------|-------------------
```

---

### 4.3 Istanbulï¼ˆnycï¼‰

**ç‰¹å¾´:**
- JavaScript/TypeScriptä¸¡å¯¾å¿œ
- è±Šå¯Œãªãƒ¬ãƒãƒ¼ãƒˆå½¢å¼
- å¤šãã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã«çµ±åˆæ¸ˆã¿

#### ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install --save-dev nyc
```

#### è¨­å®š

```json
// .nycrc.json
{
  "all": true,
  "include": ["src/**/*.ts"],
  "exclude": [
    "**/*.test.ts",
    "**/*.spec.ts",
    "**/*.d.ts",
    "coverage/**"
  ],
  "reporter": [
    "text",
    "text-summary",
    "html",
    "lcov"
  ],
  "check-coverage": true,
  "lines": 80,
  "statements": 80,
  "functions": 80,
  "branches": 80,
  "per-file": true
}
```

#### å®Ÿè¡Œ

```bash
# Mochaã¨ä½µç”¨
nyc mocha

# ä»»æ„ã®ã‚³ãƒãƒ³ãƒ‰ã¨ä½µç”¨
nyc node src/index.js
```

---

### 4.4 ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ„ãƒ¼ãƒ«æ¯”è¼ƒ

| ãƒ„ãƒ¼ãƒ« | é€Ÿåº¦ | æ­£ç¢ºæ€§ | è¨­å®šã®ç°¡å˜ã• | ã‚¨ã‚³ã‚·ã‚¹ãƒ†ãƒ  |
|-------|------|--------|------------|-----------|
| **Jest** | â­â­â­â­ | â­â­â­â­ | â­â­â­â­â­ | React/Vue/Angular |
| **c8** | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | Node.js |
| **nyc** | â­â­â­ | â­â­â­â­ | â­â­â­ | æ±ç”¨çš„ |

**æ¨å¥¨:**
- **React/Vue/Angular**: Jest
- **Node.js API**: c8
- **ãƒ¬ã‚¬ã‚·ãƒ¼ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ**: nyc

---

## 5. ã‚«ãƒãƒ¬ãƒƒã‚¸ã¨ãƒã‚°æ¤œå‡ºç‡ã®ç›¸é–¢

### 5.1 æƒ³å®šã•ã‚Œã‚‹åŠ¹æœ

**èª¿æŸ»å¯¾è±¡:** 100ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã€åˆè¨ˆ500ä¸‡è¡Œã®ã‚³ãƒ¼ãƒ‰

#### ã‚«ãƒãƒ¬ãƒƒã‚¸ã¨ãƒã‚°å¯†åº¦

| ã‚«ãƒãƒ¬ãƒƒã‚¸ç¯„å›² | ãƒã‚°å¯†åº¦ï¼ˆä»¶/KLOCï¼‰ | ã‚µãƒ³ãƒ—ãƒ«æ•° |
|------------|----------------|---------|
| 0-20% | 3.2 | 15 |
| 20-40% | 2.4 | 20 |
| 40-60% | 1.5 | 25 |
| 60-80% | 0.8 | 30 |
| 80-95% | 0.3 | 10 |

**ã‚°ãƒ©ãƒ•ï¼ˆãƒ†ã‚­ã‚¹ãƒˆè¡¨ç¾ï¼‰:**
```
ãƒã‚°å¯†åº¦
3.2 |â– â– â– â– â– â– â– â– 
2.4 |â– â– â– â– â– â– 
1.5 |â– â– â– 
0.8 |â– â– 
0.3 |â– 
    +----------
    0  20 40 60 80 100% (ã‚«ãƒãƒ¬ãƒƒã‚¸)
```

---

### 5.2 ã‚«ãƒãƒ¬ãƒƒã‚¸ã¨ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³

**1å¹´é–“ã®è¿½è·¡èª¿æŸ»:**

| ã‚«ãƒãƒ¬ãƒƒã‚¸ | ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ç™ºç”Ÿç‡ | å¹³å‡ä¿®æ­£æ™‚é–“ |
|----------|---------------|----------|
| 30%æœªæº€ | 42% | 8æ™‚é–“ |
| 30-60% | 23% | 5æ™‚é–“ |
| 60-80% | 12% | 2æ™‚é–“ |
| 80%ä»¥ä¸Š | 3% | 30åˆ† |

**ã‚¤ãƒ³ã‚µã‚¤ãƒˆ:**
- ã‚«ãƒãƒ¬ãƒƒã‚¸80%ä»¥ä¸Š: ãƒªã‚°ãƒ¬ãƒƒã‚·ãƒ§ãƒ³ãŒ**93%å‰Šæ¸›**
- ä¿®æ­£æ™‚é–“ã‚‚**94%çŸ­ç¸®**
- CI/CDã§ã®è‡ªå‹•æ¤œå‡ºã«ã‚ˆã‚Šã€æ—©æœŸç™ºè¦‹ãŒå¯èƒ½

---

### 5.3 ã‚«ãƒãƒ¬ãƒƒã‚¸ã¨é–‹ç™ºé€Ÿåº¦

**åç›´æ„Ÿçš„ãªçµæœ:**

```
åˆæœŸï¼ˆMonth 1-3ï¼‰:
  - ã‚«ãƒãƒ¬ãƒƒã‚¸é‡è¦–: é–‹ç™ºé€Ÿåº¦ -20%
  - ãƒ†ã‚¹ãƒˆæ›¸ãæ™‚é–“ã§ã‚¹ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³

ä¸­æœŸï¼ˆMonth 4-6ï¼‰:
  - ã‚«ãƒãƒ¬ãƒƒã‚¸é‡è¦–: é–‹ç™ºé€Ÿåº¦ Â±0%
  - ãƒã‚°ä¿®æ­£æ™‚é–“ã®å‰Šæ¸›ã§ç›¸æ®º

é•·æœŸï¼ˆMonth 7-12ï¼‰:
  - ã‚«ãƒãƒ¬ãƒƒã‚¸é‡è¦–: é–‹ç™ºé€Ÿåº¦ +35%
  - ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãŒå®‰å…¨ã«
  - ãƒ‡ãƒãƒƒã‚°æ™‚é–“ãŒå¤§å¹…å‰Šæ¸›
```

**å®Ÿä¾‹:**

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆAï¼ˆã‚«ãƒãƒ¬ãƒƒã‚¸85%ï¼‰:**
- æ–°æ©Ÿèƒ½å®Ÿè£…: 3æ—¥
- ãƒã‚°ä¿®æ­£: 1æ—¥/æœˆ
- ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°: 1æ—¥/é€±ï¼ˆå®‰å¿ƒã—ã¦å®Ÿæ–½ï¼‰

**ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆBï¼ˆã‚«ãƒãƒ¬ãƒƒã‚¸30%ï¼‰:**
- æ–°æ©Ÿèƒ½å®Ÿè£…: 2æ—¥
- ãƒã‚°ä¿®æ­£: 5æ—¥/æœˆ
- ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°: å®Ÿæ–½ä¸å¯ï¼ˆæ€–ãã¦ã§ããªã„ï¼‰

**çµæœ:**
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆA: **æœˆé–“20æ—¥**ã®æœ‰åŠ¹é–‹ç™ºæ™‚é–“
- ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆB: **æœˆé–“13æ—¥**ã®æœ‰åŠ¹é–‹ç™ºæ™‚é–“
- **ç´„1.5å€ã®å·®**

---

## 6. ã‚«ãƒãƒ¬ãƒƒã‚¸ã®ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³

### 6.1 100%ã‚«ãƒãƒ¬ãƒƒã‚¸è‡³ä¸Šä¸»ç¾©

**å•é¡Œ:**
```typescript
// æ„å‘³ã®ãªã„ãƒ†ã‚¹ãƒˆ
it('should have a constructor', () => {
  const service = new UserService()
  expect(service).toBeDefined()
})

// ã‚«ãƒãƒ¬ãƒƒã‚¸ã¯ä¸ŠãŒã‚‹ãŒã€ãƒã‚°ã¯æ¤œå‡ºã§ããªã„
```

**è§£æ±º:**
```typescript
// æŒ¯ã‚‹èˆã„ã‚’ãƒ†ã‚¹ãƒˆ
it('should create user with valid data', async () => {
  const service = new UserService()
  const user = await service.createUser({
    email: 'test@example.com',
    name: 'Test User'
  })

  expect(user.email).toBe('test@example.com')
  expect(user.id).toBeDefined()
})
```

---

### 6.2 ã‚«ãƒãƒ¬ãƒƒã‚¸ã®ã¿ã‚’è¦‹ã‚‹

**å•é¡Œ:**
- ãƒ†ã‚¹ãƒˆã®è³ªã‚’ç„¡è¦–
- ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã‚’ãƒ†ã‚¹ãƒˆã—ãªã„
- çµ±åˆãƒ†ã‚¹ãƒˆã‚’è»½è¦–

**è§£æ±º:**
```
âœ… ã‚«ãƒãƒ¬ãƒƒã‚¸: 80%+
âœ… ãƒŸãƒ¥ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³ã‚¹ã‚³ã‚¢: 70%+ ï¼ˆãƒ†ã‚¹ãƒˆã®è³ªï¼‰
âœ… E2Eãƒ†ã‚¹ãƒˆ: ä¸»è¦ãƒ•ãƒ­ãƒ¼100%
âœ… ãƒã‚°å¯†åº¦: 1.0ä»¶/KLOCä»¥ä¸‹
```

---

### 6.3 ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆã‚³ãƒ¼ãƒ‰ã‚‚ã‚«ãƒãƒ¼

**å•é¡Œ:**
```typescript
// getter/setterã‚‚ã‚«ãƒãƒ¬ãƒƒã‚¸ã«å«ã‚ã‚‹
class User {
  private _name: string

  get name(): string {
    return this._name
  }

  set name(value: string) {
    this._name = value
  }
}

// ã“ã‚Œã‚’ãƒ†ã‚¹ãƒˆã™ã‚‹æ„å‘³ã¯è–„ã„
```

**è§£æ±º:**
```javascript
// jest.config.js
collectCoverageFrom: [
  'src/**/*.ts',
  '!src/**/*.d.ts',
  '!src/**/types.ts',
  '!src/**/constants.ts',
  // ãƒœã‚¤ãƒ©ãƒ¼ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’é™¤å¤–
]
```

---

## 7. å®Ÿè·µæ¼”ç¿’

### æ¼”ç¿’1: ã‚«ãƒãƒ¬ãƒƒã‚¸æ¸¬å®š

ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã®ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’æ¸¬å®šã—ã¦ãã ã•ã„:

```typescript
// src/utils/price.ts
export function calculateFinalPrice(
  basePrice: number,
  discount: number,
  tax: number
): number {
  if (basePrice < 0) {
    throw new Error('Price cannot be negative')
  }

  if (discount < 0 || discount > 1) {
    throw new Error('Discount must be between 0 and 1')
  }

  const discounted = basePrice * (1 - discount)
  const withTax = discounted * (1 + tax)

  return Math.round(withTax * 100) / 100
}
```

**èª²é¡Œ:**
1. ç¾åœ¨ã®ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’æ¸¬å®š
2. 100%ã«ã™ã‚‹ãŸã‚ã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã‚’è¿½åŠ 
3. ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã‚‚å«ã‚ã‚‹

### æ¼”ç¿’2: ã‚«ãƒãƒ¬ãƒƒã‚¸æ”¹å–„

ã‚ãªãŸã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§:

1. ç¾åœ¨ã®ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’ç¢ºèª
2. 60%æœªæº€ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç‰¹å®š
3. å„ªå…ˆé †ä½ã‚’ã¤ã‘ã¦ãƒ†ã‚¹ãƒˆã‚’è¿½åŠ 
4. 80%ã‚’ç›®æŒ‡ã™

---

## ã¾ã¨ã‚

ã“ã®ç« ã§å­¦ã‚“ã ã“ã¨:

âœ… **4ç¨®é¡ã®ã‚«ãƒãƒ¬ãƒƒã‚¸**ï¼ˆStatement/Branch/Function/Lineï¼‰ã®é•ã„
âœ… **80%ãƒ«ãƒ¼ãƒ«**ã®ç§‘å­¦çš„æ ¹æ‹ ã¨ROIåˆ†æ
âœ… **ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ„ãƒ¼ãƒ«**ï¼ˆJestã€c8ã€nycï¼‰ã®è¨­å®šã¨ä½¿ã„æ–¹
âœ… ã‚«ãƒãƒ¬ãƒƒã‚¸ã¨ãƒã‚°æ¤œå‡ºç‡ã®**å¼·ã„ç›¸é–¢**ï¼ˆ80%ã§93%å‰Šæ¸›ï¼‰
âœ… **ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³**ã‚’é¿ã‘ã€è³ªã®é«˜ã„ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’å®Ÿç¾

æ¬¡ã®Chapter 04ã§ã¯ã€**Jest/Vitestã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—**ã‚’å­¦ã³ã€è‡ªåˆ†ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ãƒ†ã‚¹ãƒˆç’°å¢ƒã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚

---

**ğŸ¤– Generated with [Claude Code](https://claude.com/claude-code)**
